<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo: Live AI Agent Builder</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a5f2a 0%, #2d8a4a 100%);
            color: white;
            min-height: 100vh;
        }

        .slide {
            display: none;
            min-height: 100vh;
            padding: 30px 50px;
            flex-direction: column;
        }

        .slide.active {
            display: flex;
        }

        .slide-content {
            flex: 1;
            overflow-y: auto;
        }

        h1 {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 2.4em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            border-bottom: 3px solid rgba(255,255,255,0.5);
            padding-bottom: 10px;
        }

        h2 {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.8em;
            margin-bottom: 15px;
            color: #90EE90;
        }

        h3 {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.4em;
            margin: 15px 0 10px 0;
            color: #98FB98;
        }

        p {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.1em;
            line-height: 1.5;
            margin-bottom: 12px;
        }

        ul {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin-left: 25px;
            line-height: 1.8;
        }

        .demo-container {
            background-color: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 25px;
            margin: 15px 0;
        }

        .chart-container {
            background-color: rgba(255,255,255,0.95);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            align-items: flex-end;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group.wide {
            flex: 1;
            min-width: 250px;
        }

        label {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.95em;
            color: #90EE90;
        }

        select, input, textarea {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 10px 15px;
            border-radius: 5px;
            border: none;
            font-size: 1em;
            background-color: rgba(255,255,255,0.9);
            color: #1a5f2a;
        }

        input[type="password"] {
            font-family: 'Courier New', Courier, monospace;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
            width: 100%;
        }

        .btn {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #90EE90;
            color: #1a5f2a;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .btn:hover:not(:disabled) {
            background-color: white;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .api-key-section {
            background-color: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .api-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-left: 15px;
        }

        .api-status.connected {
            background-color: rgba(144, 238, 144, 0.3);
            color: #90EE90;
        }

        .api-status.disconnected {
            background-color: rgba(255, 99, 132, 0.3);
            color: #ff6b6b;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .connected .status-dot {
            background-color: #90EE90;
        }

        .disconnected .status-dot {
            background-color: #ff6b6b;
        }

        .agent-trace {
            background-color: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
        }

        .trace-step {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid #90EE90;
            background-color: rgba(255,255,255,0.05);
        }

        .trace-step.thought {
            border-left-color: #FFD700;
        }

        .trace-step.action {
            border-left-color: #87CEEB;
        }

        .trace-step.observation {
            border-left-color: #90EE90;
        }

        .trace-step.error {
            border-left-color: #ff6b6b;
        }

        .trace-label {
            font-weight: bold;
            color: #90EE90;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin-bottom: 5px;
        }

        .tool-card {
            background-color: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .tool-card:hover {
            background-color: rgba(255,255,255,0.15);
        }

        .tool-card.selected {
            border-color: #90EE90;
            background-color: rgba(144, 238, 144, 0.2);
        }

        .tool-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .three-column {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .highlight-box {
            background-color: rgba(255,255,255,0.15);
            border-left: 4px solid #90EE90;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .code-table {
            width: 100%;
            margin: 15px 0;
            border-collapse: collapse;
            background-color: #1a1a2e;
            border-radius: 8px;
            overflow: hidden;
        }

        .code-table td {
            padding: 15px;
        }

        .code-table code {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.85em;
            color: #00ff00;
            white-space: pre;
            display: block;
            line-height: 1.4;
        }

        .code-label {
            background-color: #2d2d44;
            color: #90EE90;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.85em;
            padding: 8px 15px !important;
            border-bottom: 1px solid #444;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-top: auto;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        .nav-btn {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 25px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .nav-btn:hover:not(:disabled) {
            background-color: white;
            color: #1a5f2a;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .slide-counter {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1em;
            opacity: 0.8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .stat-card {
            background-color: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.8em;
            font-weight: bold;
            color: #90EE90;
        }

        .stat-label {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.85em;
            opacity: 0.8;
        }

        .error-message {
            background-color: rgba(255, 99, 132, 0.2);
            border: 1px solid rgba(255, 99, 132, 0.5);
            color: #ff6b6b;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .chat-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .chat-input input {
            flex: 1;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: #90EE90;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 900px) {
            .two-column, .three-column {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Available tools for the agent
        const AVAILABLE_TOOLS = [
            {
                id: 'calculator',
                name: 'Calculator',
                icon: 'üî¢',
                description: 'Perform mathematical calculations',
                examples: ['2 + 2', '15 * 7', 'sqrt(144)']
            },
            {
                id: 'weather',
                name: 'Weather',
                icon: 'üå§Ô∏è',
                description: 'Get current weather for a location',
                examples: ['London', 'New York', 'Tokyo']
            },
            {
                id: 'search',
                name: 'Web Search',
                icon: 'üîç',
                description: 'Search the web for information',
                examples: ['latest AI news', 'Python tutorials']
            },
            {
                id: 'datetime',
                name: 'Date/Time',
                icon: 'üìÖ',
                description: 'Get current date and time information',
                examples: ['current time', 'days until Christmas']
            }
        ];

        // Simulated tool execution
        const executeLocalTool = (toolId, input) => {
            switch (toolId) {
                case 'calculator':
                    try {
                        const result = Function('"use strict"; return (' + input.replace(/sqrt/g, 'Math.sqrt').replace(/pow/g, 'Math.pow') + ')')();
                        return { success: true, result: `${result}` };
                    } catch (e) {
                        return { success: false, result: 'Invalid expression' };
                    }
                case 'weather':
                    const weathers = ['sunny', 'cloudy', 'rainy', 'partly cloudy'];
                    const temp = Math.floor(Math.random() * 25) + 10;
                    return { success: true, result: `Weather in ${input}: ${weathers[Math.floor(Math.random() * weathers.length)]}, ${temp}¬∞C` };
                case 'datetime':
                    return { success: true, result: `Current date/time: ${new Date().toLocaleString()}` };
                case 'search':
                    return { success: true, result: `Search results for "${input}": [Simulated search results would appear here]` };
                default:
                    return { success: false, result: 'Unknown tool' };
            }
        };

        // Slide 1: Title & API Setup
        function TitleSlide({ apiKey, setApiKey, isConnected, setIsConnected }) {
            const [testing, setTesting] = useState(false);
            const [error, setError] = useState('');

            const testConnection = async () => {
                if (!apiKey.trim()) {
                    setError('Please enter an API key');
                    return;
                }
                setTesting(true);
                setError('');
                try {
                    const res = await fetch('https://api.openai.com/v1/models', {
                        headers: { 'Authorization': `Bearer ${apiKey}` }
                    });
                    setIsConnected(res.ok);
                    if (!res.ok) {
                        const data = await res.json();
                        setError(data.error?.message || 'Invalid API key');
                    }
                } catch (err) {
                    setError('Connection failed');
                    setIsConnected(false);
                }
                setTesting(false);
            };

            return (
                <div className="slide-content">
                    <div style={{textAlign: 'center', marginBottom: '30px'}}>
                        <h2>Interactive Demo</h2>
                        <h1 style={{fontSize: '2.8em', borderBottom: 'none'}}>Live AI Agent Builder</h1>
                        <p style={{fontSize: '1.2em', opacity: 0.9}}>Building & Running ReAct Agents</p>
                    </div>

                    <div className="api-key-section">
                        <h3>
                            OpenAI API Connection
                            <span className={`api-status ${isConnected ? 'connected' : 'disconnected'}`}>
                                <span className="status-dot"></span>
                                {isConnected ? 'Connected' : 'Not Connected'}
                            </span>
                        </h3>
                        <div className="controls">
                            <div className="control-group wide">
                                <label>API Key:</label>
                                <input
                                    type="password"
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                    placeholder="sk-..."
                                    style={{width: '100%'}}
                                />
                            </div>
                            <div className="control-group">
                                <label>&nbsp;</label>
                                <button className="btn" onClick={testConnection} disabled={testing}>
                                    {testing ? 'Testing...' : 'Test Connection'}
                                </button>
                            </div>
                        </div>
                        {error && <div className="error-message">{error}</div>}
                    </div>

                    <div className="highlight-box">
                        <h3>What This Demo Covers</h3>
                        <ul>
                            <li>Build a ReAct agent with custom tools</li>
                            <li>Watch the reasoning-action loop in real-time</li>
                            <li>See how agents decide which tools to use</li>
                            <li>Compare different agent strategies</li>
                        </ul>
                    </div>
                </div>
            );
        }

        // Slide 2: Tool Selection
        function ToolSelectionSlide({ selectedTools, setSelectedTools }) {
            const toggleTool = (toolId) => {
                if (selectedTools.includes(toolId)) {
                    setSelectedTools(selectedTools.filter(t => t !== toolId));
                } else {
                    setSelectedTools([...selectedTools, toolId]);
                }
            };

            return (
                <div className="slide-content">
                    <h1>Configure Agent Tools</h1>
                    <p>Select the tools your agent will have access to. Each tool extends the agent's capabilities.</p>

                    <div className="demo-container">
                        <h3>Available Tools (click to toggle)</h3>
                        <div className="three-column">
                            {AVAILABLE_TOOLS.map(tool => (
                                <div
                                    key={tool.id}
                                    className={`tool-card ${selectedTools.includes(tool.id) ? 'selected' : ''}`}
                                    onClick={() => toggleTool(tool.id)}
                                >
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '10px'}}>
                                        <span className="tool-icon">{tool.icon}</span>
                                        <strong>{tool.name}</strong>
                                    </div>
                                    <p style={{fontSize: '0.9em', opacity: 0.8, marginBottom: '10px'}}>
                                        {tool.description}
                                    </p>
                                    <div style={{fontSize: '0.8em', opacity: 0.6}}>
                                        Examples: {tool.examples.join(', ')}
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="stats-grid" style={{marginTop: '20px'}}>
                            <div className="stat-card">
                                <div className="stat-value">{selectedTools.length}</div>
                                <div className="stat-label">Tools Selected</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">{AVAILABLE_TOOLS.length}</div>
                                <div className="stat-label">Available</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">ReAct</div>
                                <div className="stat-label">Agent Type</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">5</div>
                                <div className="stat-label">Max Iterations</div>
                            </div>
                        </div>
                    </div>

                    <div className="highlight-box">
                        <p><strong>Tip:</strong> More tools = more capabilities, but also more complexity for the agent to reason about. Start with 2-3 relevant tools.</p>
                    </div>
                </div>
            );
        }

        // Slide 3: Live Agent Execution
        function AgentExecutionSlide({ apiKey, isConnected, selectedTools }) {
            const [query, setQuery] = useState('What is 25 * 17 and what is the weather in London?');
            const [trace, setTrace] = useState([]);
            const [loading, setLoading] = useState(false);
            const [iterations, setIterations] = useState(0);
            const [finalAnswer, setFinalAnswer] = useState('');
            const traceRef = useRef(null);

            const addTraceStep = (type, content) => {
                setTrace(prev => [...prev, { type, content, timestamp: new Date().toLocaleTimeString() }]);
            };

            const runAgent = async () => {
                if (!isConnected || !apiKey) return;

                setLoading(true);
                setTrace([]);
                setIterations(0);
                setFinalAnswer('');

                const tools = AVAILABLE_TOOLS.filter(t => selectedTools.includes(t.id));
                const toolDescriptions = tools.map(t => `- ${t.name}: ${t.description}`).join('\n');

                const systemPrompt = `You are a helpful AI agent that uses tools to answer questions.

Available tools:
${toolDescriptions}

To use a tool, respond with:
THOUGHT: [your reasoning about what to do]
ACTION: [tool_name]
ACTION_INPUT: [input for the tool]

After receiving tool results, continue reasoning or provide final answer:
THOUGHT: [your reasoning]
FINAL_ANSWER: [your complete answer to the user]

Always think step by step. Use tools when needed.`;

                let messages = [
                    { role: 'system', content: systemPrompt },
                    { role: 'user', content: query }
                ];

                addTraceStep('user', `User: ${query}`);

                let maxIterations = 5;
                let iteration = 0;

                while (iteration < maxIterations) {
                    iteration++;
                    setIterations(iteration);

                    try {
                        const response = await fetch('https://api.openai.com/v1/chat/completions', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${apiKey}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                model: 'gpt-3.5-turbo',
                                messages: messages,
                                temperature: 0.3
                            })
                        });

                        const data = await response.json();
                        const assistantMessage = data.choices[0].message.content;

                        // Parse the response
                        const thoughtMatch = assistantMessage.match(/THOUGHT:\s*(.+?)(?=ACTION:|FINAL_ANSWER:|$)/s);
                        const actionMatch = assistantMessage.match(/ACTION:\s*(\w+)/);
                        const inputMatch = assistantMessage.match(/ACTION_INPUT:\s*(.+?)(?=THOUGHT:|ACTION:|FINAL_ANSWER:|$)/s);
                        const finalMatch = assistantMessage.match(/FINAL_ANSWER:\s*(.+)/s);

                        if (thoughtMatch) {
                            addTraceStep('thought', `Thought: ${thoughtMatch[1].trim()}`);
                        }

                        if (actionMatch && inputMatch) {
                            const toolName = actionMatch[1].toLowerCase();
                            const toolInput = inputMatch[1].trim();

                            addTraceStep('action', `Action: ${toolName}(${toolInput})`);

                            // Execute the tool
                            const tool = tools.find(t => t.name.toLowerCase().includes(toolName) || t.id === toolName);
                            let observation;

                            if (tool) {
                                const result = executeLocalTool(tool.id, toolInput);
                                observation = result.result;
                            } else {
                                observation = `Tool "${toolName}" not found`;
                            }

                            addTraceStep('observation', `Observation: ${observation}`);

                            messages.push({ role: 'assistant', content: assistantMessage });
                            messages.push({ role: 'user', content: `Observation: ${observation}` });

                        } else if (finalMatch) {
                            const answer = finalMatch[1].trim();
                            setFinalAnswer(answer);
                            addTraceStep('final', `Final Answer: ${answer}`);
                            break;
                        } else {
                            // No clear structure, treat as final answer
                            setFinalAnswer(assistantMessage);
                            addTraceStep('final', `Final Answer: ${assistantMessage}`);
                            break;
                        }

                    } catch (err) {
                        addTraceStep('error', `Error: ${err.message}`);
                        break;
                    }
                }

                setLoading(false);
            };

            useEffect(() => {
                if (traceRef.current) {
                    traceRef.current.scrollTop = traceRef.current.scrollHeight;
                }
            }, [trace]);

            return (
                <div className="slide-content">
                    <h1>Live Agent Execution</h1>
                    <p>Watch the ReAct loop: Reasoning ‚Üí Action ‚Üí Observation ‚Üí Repeat</p>

                    <div className="demo-container">
                        <div className="chat-input">
                            <input
                                type="text"
                                value={query}
                                onChange={(e) => setQuery(e.target.value)}
                                placeholder="Ask the agent something..."
                                style={{flex: 1}}
                            />
                            <button className="btn" onClick={runAgent} disabled={loading || !isConnected || selectedTools.length === 0}>
                                {loading ? <><span className="spinner"></span>Running...</> : 'Run Agent'}
                            </button>
                        </div>

                        {selectedTools.length === 0 && (
                            <div className="error-message">
                                Please select at least one tool on the previous slide.
                            </div>
                        )}

                        <div className="stats-grid" style={{marginTop: '15px'}}>
                            <div className="stat-card">
                                <div className="stat-value">{iterations}</div>
                                <div className="stat-label">Iterations</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">{trace.filter(t => t.type === 'action').length}</div>
                                <div className="stat-label">Tool Calls</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">{selectedTools.length}</div>
                                <div className="stat-label">Tools Available</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">{loading ? '‚è≥' : finalAnswer ? '‚úÖ' : '‚è∏Ô∏è'}</div>
                                <div className="stat-label">Status</div>
                            </div>
                        </div>

                        <h3>Agent Trace</h3>
                        <div className="agent-trace" ref={traceRef}>
                            {trace.length === 0 ? (
                                <div style={{opacity: 0.5, textAlign: 'center', padding: '20px'}}>
                                    Agent trace will appear here...
                                </div>
                            ) : (
                                trace.map((step, i) => (
                                    <div key={i} className={`trace-step ${step.type}`}>
                                        <div className="trace-label">[{step.timestamp}] {step.type.toUpperCase()}</div>
                                        <div>{step.content}</div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Slide 4: Chain of Thought Demo
        function ChainOfThoughtSlide({ apiKey, isConnected }) {
            const [problem, setProblem] = useState('If a train travels at 60 mph for 2.5 hours, then at 80 mph for 1.5 hours, what is the total distance traveled?');
            const [withCoT, setWithCoT] = useState('');
            const [withoutCoT, setWithoutCoT] = useState('');
            const [loading, setLoading] = useState(false);

            const runComparison = async () => {
                if (!isConnected || !apiKey) return;

                setLoading(true);
                setWithCoT('');
                setWithoutCoT('');

                try {
                    const [cotRes, directRes] = await Promise.all([
                        fetch('https://api.openai.com/v1/chat/completions', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${apiKey}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                model: 'gpt-3.5-turbo',
                                messages: [{
                                    role: 'user',
                                    content: `${problem}\n\nLet's solve this step by step:\n1.`
                                }],
                                temperature: 0.3
                            })
                        }),
                        fetch('https://api.openai.com/v1/chat/completions', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${apiKey}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                model: 'gpt-3.5-turbo',
                                messages: [{
                                    role: 'user',
                                    content: `${problem}\n\nAnswer with just the final number:`
                                }],
                                temperature: 0.3
                            })
                        })
                    ]);

                    const cotData = await cotRes.json();
                    const directData = await directRes.json();

                    setWithCoT(cotData.choices[0].message.content);
                    setWithoutCoT(directData.choices[0].message.content);

                } catch (err) {
                    console.error(err);
                }

                setLoading(false);
            };

            return (
                <div className="slide-content">
                    <h1>Chain-of-Thought Prompting</h1>
                    <p>Compare step-by-step reasoning vs direct answers.</p>

                    <div className="demo-container">
                        <div className="control-group" style={{marginBottom: '15px'}}>
                            <label>Problem:</label>
                            <textarea
                                value={problem}
                                onChange={(e) => setProblem(e.target.value)}
                            />
                        </div>

                        <button className="btn" onClick={runComparison} disabled={loading || !isConnected}>
                            {loading ? 'Running...' : 'Compare Approaches'}
                        </button>

                        <div className="two-column" style={{marginTop: '20px'}}>
                            <div>
                                <h3 style={{color: '#90EE90'}}>With Chain-of-Thought</h3>
                                <div className="agent-trace" style={{minHeight: '200px'}}>
                                    {withCoT || <span style={{opacity: 0.5}}>Response will appear here...</span>}
                                </div>
                            </div>
                            <div>
                                <h3 style={{color: '#FF6384'}}>Direct Answer</h3>
                                <div className="agent-trace" style={{minHeight: '200px'}}>
                                    {withoutCoT || <span style={{opacity: 0.5}}>Response will appear here...</span>}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="highlight-box">
                        <p><strong>Key Insight:</strong> Chain-of-thought prompting improves accuracy on reasoning tasks by making the model show its work.</p>
                    </div>
                </div>
            );
        }

        // Slide 5: Code Implementation
        function CodeSlide() {
            return (
                <div className="slide-content">
                    <h1>Agent Implementation Code</h1>

                    <table className="code-table">
                        <tbody>
                            <tr><td className="code-label">Python: LangChain ReAct Agent</td></tr>
                            <tr><td><code>{`from langchain.agents import create_openai_tools_agent, AgentExecutor
from langchain_openai import ChatOpenAI
from langchain.tools import Tool
from langchain_core.prompts import ChatPromptTemplate

# Define tools
tools = [
    Tool(name="Calculator", func=lambda x: eval(x),
         description="Useful for math calculations"),
    Tool(name="Weather", func=get_weather,
         description="Get weather for a location"),
]

# Create prompt
prompt = ChatPromptTemplate.from_messages([
    ("system", "You are a helpful assistant with tools."),
    ("human", "{input}"),
    ("placeholder", "{agent_scratchpad}")
])

# Create agent
llm = ChatOpenAI(model="gpt-4", temperature=0)
agent = create_openai_tools_agent(llm, tools, prompt)
executor = AgentExecutor(agent=agent, tools=tools, verbose=True)

# Run
result = executor.invoke({"input": "What's 25*17?"})`}</code></td></tr>
                        </tbody>
                    </table>

                    <div className="highlight-box">
                        <h3>Agent Design Patterns</h3>
                        <ul>
                            <li><strong>ReAct:</strong> Reason + Act in interleaved steps</li>
                            <li><strong>Plan-and-Execute:</strong> Create plan first, then execute</li>
                            <li><strong>Tree of Thoughts:</strong> Explore multiple reasoning paths</li>
                            <li><strong>Reflection:</strong> Self-critique and improve outputs</li>
                        </ul>
                    </div>
                </div>
            );
        }

        // Slide 6: Summary
        function SummarySlide() {
            return (
                <div className="slide-content" style={{display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: '80vh', textAlign: 'center'}}>
                    <h1 style={{borderBottom: 'none'}}>Demo Complete!</h1>
                    <h3 style={{marginTop: '30px'}}>Key Takeaways</h3>
                    <div style={{textAlign: 'left', maxWidth: '600px', margin: '20px auto'}}>
                        <ul style={{fontSize: '1.1em', lineHeight: '1.8'}}>
                            <li>Agents extend LLMs with tool-use capabilities</li>
                            <li>ReAct pattern: Thought ‚Üí Action ‚Üí Observation</li>
                            <li>Tool selection is crucial for agent effectiveness</li>
                            <li>Chain-of-thought improves reasoning accuracy</li>
                            <li>Limit iterations to prevent infinite loops</li>
                            <li>Verbose mode helps debug agent behavior</li>
                        </ul>
                    </div>
                    <p style={{marginTop: '30px', opacity: 0.7}}>Continue to Module 3: Advanced Agents</p>
                </div>
            );
        }

        // Main App
        function App() {
            const [currentSlide, setCurrentSlide] = useState(0);
            const [apiKey, setApiKey] = useState('');
            const [isConnected, setIsConnected] = useState(false);
            const [selectedTools, setSelectedTools] = useState(['calculator', 'weather']);

            const slides = [
                (props) => <TitleSlide {...props} />,
                (props) => <ToolSelectionSlide selectedTools={selectedTools} setSelectedTools={setSelectedTools} />,
                (props) => <AgentExecutionSlide {...props} selectedTools={selectedTools} />,
                (props) => <ChainOfThoughtSlide {...props} />,
                () => <CodeSlide />,
                () => <SummarySlide />
            ];
            const totalSlides = slides.length;

            const nextSlide = () => {
                if (currentSlide < totalSlides - 1) setCurrentSlide(currentSlide + 1);
            };

            const prevSlide = () => {
                if (currentSlide > 0) setCurrentSlide(currentSlide - 1);
            };

            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
                    if (e.key === 'ArrowRight' || e.key === ' ') {
                        e.preventDefault();
                        nextSlide();
                    } else if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        prevSlide();
                    }
                };
                document.addEventListener('keydown', handleKeyDown);
                return () => document.removeEventListener('keydown', handleKeyDown);
            }, [currentSlide]);

            const CurrentSlideComponent = slides[currentSlide];

            return (
                <div className="slide active">
                    <CurrentSlideComponent
                        apiKey={apiKey}
                        setApiKey={setApiKey}
                        isConnected={isConnected}
                        setIsConnected={setIsConnected}
                    />
                    <div className="navigation">
                        <button className="nav-btn" onClick={prevSlide} disabled={currentSlide === 0}>
                            ‚Üê Previous
                        </button>
                        <span className="slide-counter">Slide {currentSlide + 1} of {totalSlides}</span>
                        <button className="nav-btn" onClick={nextSlide} disabled={currentSlide === totalSlides - 1}>
                            Next ‚Üí
                        </button>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
